---
layout: post
title:  "CHOLLA_PM: PLMP Advected Internal Energy Comparison"
date:   2019-04-24 17:10:24 -0800
categories: cholla
---


**Column 1:**  ENZO

**Column 2:**  Phase diagram for All Gas ( top ) and Neutral Hydrogen ( bottom ). Temperature is internally computed by Grackle on run time.

**Column 3:**  Phase diagram for the fraction of the gas that uses the Total Internal Energy to compute pressure.

**Column 4:**  Phase diagram for the fraction of the gas that uses the Adavected Internal Energy to compute pressure.


**Column 5:**  Phase diagram showing the temperature computed from the Total Internal Energy for ALL the gas.

**Column 6:**  Phase diagram showing the temperature computed from the Advected Internal Energy for ALL the gas.

Here is a comparison of the phase diagram using PLMP reconstruction changing the way the Advected Internal Energy is evolved.

**Row 1:** The $$p \nabla \cdot \mathbf{v} $$ term is applied at the half-step and at the complete time step.

**Row 2:** The $$p \nabla \cdot \mathbf{v} $$ term is **not** applied at the half-step, it's only applied at the complete time step.

**Row 3:** The $$p \nabla \cdot \mathbf{v} $$ term is **not** applied at the half-step. At the end of the half update an internal energy is selected ( Advected or Total ) and that value is used to set the Total Energy ( kinetic + internal ), for the subsequent steps the pressure is always computed from the Total Energy avoiding mixing of Advected Internal Energy or Total Internal Energy for individual cells.

<div style="text-align: center">
<video src="{{ site.url }}assets/videos/phase_diagram_PLMP_all.mp4" width="500" height="500" controls preload> </video>
</div>
